#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed May  3 16:56:28 2023

@author: johnmorgan
"""

class UnionFind:
    # Constructor
    def __init__(self, n):
        self.parent = list(range(n))
        self.rank = [1] * n

    # Function to find which subset a particular element belongs.
    def find(self, i):
        if self.parent[i] != i:
            self.parent[i] = self.find(self.parent[i])
        return self.parent[i]

    # Function to join two subsets into a single subset.
    def union(self, x, y):
        p1, p2 = map(self.find, (x, y))
        if p1 == p2:
            return
        small, big = sorted([p1, p2], key=lambda z: self.rank[z])
        self.parent[small] = big
        self.rank[big] += self.rank[small]